{% extends 'layout.html.twig' %}

{% block body %}
    {{ parent() }}
    
    <div class = "main container">
        <div class = "row well">
            <div class = "col-md-12">
                <div class = "page-header">
                    <h2>Nueva Pregunta</h2>
                </div>
                
                <h4 class="text-danger"> {{ form_errors(form) }} </h4>
                
                <fieldset>
                
                {{ form_start(form, {'attr' : {'novalidate' : 'novalidate', 'role' : 'form'} }) }}
                
                <div class="row">
                
                	<div class = 'col-md-4 form-group'>
                        {{ form_label(form.competencia) }}
                        {{ form_widget(form.competencia, { 'attr' : { 'class' : 'form-control' 
                            } }) }}   
                    </div>
                    
                    <div class = 'col-md-4 form-group'>
                        {{ form_label(form.factor) }}
                        {{ form_widget(form.factor, { 'attr' : { 'class' : 'form-control' 
                            } }) }}
                            
                    </div>
                    
                    <div class = 'col-md-4 form-group'>
                        {{ form_label(form.codigo) }}
                        {{ form_widget(form.codigo, { 'attr' : { 'class' : 'form-control' , 
                            'placeholder' : 'Código de la pregunta',
                            } }) }}
                        <span class='text-danger'> {{form_errors(form.codigo) }} </span>
                    </div>
                
                    
                </div>
                
           		<div class="row">
           		
           		<div class = 'col-md-4 form-group'>
                        {{ form_label(form.nombre) }}
                        {{ form_widget(form.nombre, { 'attr' : { 'class' : 'form-control' , 
                            'placeholder' : 'Nombre'
                            } }) }}
                        <span class='text-danger'> {{form_errors(form.nombre) }} </span>
                    </div>
                    
                	<div class = 'col-md-8 form-group'>
                        {{ form_label(form.pregunta) }}
                        {{ form_widget(form.pregunta, { 'attr' : { 'class' : 'form-control' , 
                            'placeholder' : 'Pregunta'
                            } }) }}
                        <span class='text-danger'> {{form_errors(form.pregunta) }} </span>
                    </div>
            
                    
                </div>
                
                <div class="row">
                    <div class = 'col-md-12 form-group'>
                        {{ form_label(form.descripcion) }}
                        {{ form_widget(form.descripcion, { 'attr' : { 'class' : 'form-control' , 
                            'placeholder' : 'Descripción de la pregunta'
                            } }) }}
                        <span class='text-danger'> {{form_errors(form.descripcion) }} </span>
                    </div>
                    
                </div>     
                
                </fieldset>
                
                <p>
                    
                    {{ form_widget(form.save, {'label' : 'Guardar', 'attr' : {'class' : 'btn btn-success' } }) }}
                    <a href="{{ path('ich_pregunta_index') }}" class="btn btn-warning">Cancelar</a>
                    
                </p>
               
                {{ form_rest(form) }}
                
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

<script>
    $competencia =  $("#pregunta_competencia");
        $(function(){
          $competencia.change(function(){
                 var data = {
                     competencia_id: $(this).val()
                 };

                 $.ajax({
                     type: 'post',
                     url: '{{ path("ich_pregunta_create") }}',
                     data: data,
                    success: function(data) {
                        var $factor_selector = $('#pregunta_factor');

                        $factor_selector.html('<option>Factor</option>');

                        for (var i=0, total = data.length; i < total; i++) {
                            $factor_selector.append('<option value="' + data[i].id + '">' + data[i].nombre + '</option>');
                        }
                        
                       
                    }
                });
            });

            });
    </script>
{% endblock %}

